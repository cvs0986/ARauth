# ARauth Identity IAM - Production Environment Configuration

# ============================================================================
# ENVIRONMENT
# ============================================================================
ENVIRONMENT=production
DEBUG=false

# ============================================================================
# DATABASE
# ============================================================================
DATABASE_URL=postgresql://user:password@host:5432/arauth
DATABASE_MAX_OPEN_CONNS=25
DATABASE_MAX_IDLE_CONNS=5
DATABASE_CONN_MAX_LIFETIME=5m

# ============================================================================
# REDIS (REQUIRED for production)
# ============================================================================
REDIS_URL=redis://host:6379/0
REDIS_PASSWORD=
REDIS_DB=0
REDIS_MAX_RETRIES=3
REDIS_POOL_SIZE=10

# ============================================================================
# SECURITY
# ============================================================================
# JWT Configuration
JWT_SIGNING_KEY=<CHANGE-ME-32-byte-random-key-for-production>
JWT_ISSUER=https://your-domain.com
JWT_AUDIENCE=https://your-domain.com

# Encryption (AES-256 requires exactly 32 bytes)
ENCRYPTION_KEY=<CHANGE-ME-32-byte-encryption-key>

# TOTP/MFA
TOTP_ISSUER=ARauth Identity

# ============================================================================
# RATE LIMITING (Conservative defaults - tune based on traffic)
# ============================================================================
# Per-user rate limits (requests per minute)
RATE_LIMIT_USER_RPM=60

# Per-OAuth-client rate limits (requests per minute)
RATE_LIMIT_CLIENT_RPM=100

# Per-IP rate limits for admin endpoints (requests per minute)
RATE_LIMIT_ADMIN_IP_RPM=30

# Note: Auth endpoints (login/token) and sensitive endpoints (MFA/password reset)
# have stricter built-in limits that cannot be overridden via environment variables.
# See docs/deployment/PRODUCTION.md for details.

# ============================================================================
# HYDRA (OAuth2 Server)
# ============================================================================
HYDRA_ADMIN_URL=http://hydra:4445
HYDRA_PUBLIC_URL=https://your-domain.com/oauth2

# ============================================================================
# SERVER
# ============================================================================
SERVER_HOST=0.0.0.0
SERVER_PORT=8080
SERVER_READ_TIMEOUT=15s
SERVER_WRITE_TIMEOUT=15s
SERVER_IDLE_TIMEOUT=60s

# ============================================================================
# LOGGING
# ============================================================================
LOG_LEVEL=info
LOG_FORMAT=json
LOG_OUTPUT=stdout

# ============================================================================
# CORS
# ============================================================================
CORS_ALLOWED_ORIGINS=https://your-domain.com
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,PATCH
CORS_ALLOWED_HEADERS=Authorization,Content-Type
CORS_ALLOW_CREDENTIALS=true

# ============================================================================
# EMAIL (Optional - for invitations)
# ============================================================================
EMAIL_PROVIDER=smtp
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_USERNAME=
SMTP_PASSWORD=
SMTP_FROM=noreply@your-domain.com

# ============================================================================
# OBSERVABILITY (Future - Phase C.2)
# ============================================================================
# SECURITY_EVENTS_ENABLED=true
# METRICS_ENABLED=true
# TRACING_ENABLED=true
